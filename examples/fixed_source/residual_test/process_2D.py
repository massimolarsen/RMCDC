import matplotlib.pyplot as plt
import h5py
import numpy as np


phi = np.sum(np.array([[[4.99956336, 4.99990169, 5.00002407, 5.00000099],
  [1.66659425, 1.66663293, 1.66664876, 1.66666114]],

 [[2.49981236, 2.49972157, 2.50002624, 2.50003183],
  [1.2499384,  1.24997771, 1.24999352, 1.25000439]]]),2)


error_10000 = np.array([38.13043355190904, 5.282391207659098, 1.6161592159598224, 0.6635986838212375, 0.2812978249944741, 0.1278990159009841, 0.05622475564439766, 0.02767200912344771, 0.012344653365653201, 0.005100776107643643, 0.0019744220112766987, 0.0007355256893994795, 0.00024858673734188885, 9.022363832702349e-05, 2.8622942402863915e-05, 1.0707339471640025e-05, 3.1819378526765727e-06, 9.833245634128665e-07, 3.0891791258311705e-07, 9.41074252570019e-08, 3.1548219638823705e-08, 9.631237754860274e-09, 2.9211597751367042e-09, 8.349167611707932e-10, 2.480348483105378e-10, 6.961073947843663e-11, 2.175599238688858e-11, 6.980092639001093e-12, 2.1173163055065337e-12, 5.850897879506055e-13, 1.9628790680074426e-13, 5.477722195680567e-14, 1.613496603418405e-14, 4.788523239932228e-15, 1.5317760143133859e-15])
x_10000 = np.arange(0,35,1)
error_1000 = np.array([38.463320472167744, 11.18880534105218, 4.1836898072226205, 1.9639600657607714, 0.8989363029278042, 0.45621190021631114, 0.17149833811026646, 0.0852849652487105, 0.029664186471849163, 0.019628140999246084, 0.008728051832638813, 0.004112113484361185, 0.001594356697005832, 0.0004279255852163756, 0.00017220730964215216, 6.652489979371961e-05, 2.6845640174374958e-05, 8.696535155408302e-06, 3.309264357807202e-06, 1.4542175691163985e-06, 6.434276395654319e-07, 2.48937779961117e-07, 1.0644943039097596e-07, 3.980514563866577e-08, 1.6162244143806065e-08, 5.6608330015141036e-09, 2.1900098702794034e-09, 9.203541483802312e-10, 5.045426774687747e-10, 2.2438128930169143e-10, 8.187367611983293e-11, 3.987722735322187e-11, 1.5728414062387993e-11, 5.639839321621273e-12, 2.542103023001924e-12, 8.580343166983954e-13, 3.121456494659983e-13, 1.2060605582684723e-13, 4.170947872282624e-14, 1.9855212681771426e-14, 9.268234213723509e-15, 3.5508421240299586e-15, 1.586484147325877e-15])
x_1000 = np.arange(0,43,1)
error_5000 = np.array([37.97930805364052, 5.521314966176549, 1.9100284641645904, 0.8196955955180738, 0.3735545293988416, 0.1714024282456555, 0.07324162975424653, 0.035482879874876735, 0.015609406673286213, 0.006097624575168698, 0.0022867620163452445, 0.0010303684779667886, 0.0003721994123661199, 0.0001298442897774414, 4.1262419204320066e-05, 1.4448372325628929e-05, 4.533209798341139e-06, 1.4726738372321166e-06, 4.5685311651321074e-07, 1.415519387761416e-07, 5.096594494757804e-08, 1.9312244729554467e-08, 6.9268353413548585e-09, 2.503364380911363e-09, 1.0748074234263726e-09, 3.3816561279616455e-10, 9.811213855487683e-11, 3.971898286954487e-11, 1.2341856590056514e-11, 4.424593856239396e-12, 1.2495087280176735e-12, 
4.279334955828332e-13, 1.2595163261114805e-13, 3.7720757504613557e-14, 9.307272760115113e-15, 3.686619496546331e-15, 1.6144986001039543e-15])
x_5000 = np.arange(0,37,1)

# Plot result
plt.plot(x_1000,error_1000, marker="o",markerfacecolor='none',markersize=6,label="$1000$ Particles/Iteration")
plt.plot(x_5000,error_5000, marker="^",markerfacecolor='none', markersize=6,label="$5000$ Particles/Iteration")
plt.plot(x_10000,error_10000, marker="s",markerfacecolor='none', markersize=6,label="$10000$ Particles/Iteration")
plt.yscale('log')
plt.title('4 $x$ bins, 4 $y$ bins, 4 angle || $\sigma_s = 1$, $\sigma_a$=2, $Q=5$')
plt.ylabel('$L^2$ Norm of Error Estimator')
plt.xlabel('Iteration #')
plt.legend()
plt.show()
